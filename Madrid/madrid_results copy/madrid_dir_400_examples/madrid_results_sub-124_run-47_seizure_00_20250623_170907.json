{
  "analysis_metadata": {
    "analysis_id": "madrid_sub-124_run-47_seizure_00_20250623_170907",
    "timestamp": "2025-06-23T17:09:07.665603Z",
    "madrid_version": "1.0.0",
    "analysis_type": "single_file",
    "computation_info": {
      "execution_time_seconds": 121.31927704811096,
      "gpu_used": true,
      "memory_peak_mb": 0,
      "analysis_successful": true
    }
  },
  "input_data": {
    "source_file": "/home/swolf/asim_shared/preprocessed_data/seizure_only/8hz_30min/downsample_8hz_context_30min/sub-124_run-47_seizure_00_preprocessed.pkl",
    "subject_id": "sub-124",
    "run_id": "run-47",
    "seizure_id": "seizure_00",
    "signal_metadata": {
      "sampling_rate": 8,
      "original_sampling_rate": 250,
      "signal_length_samples": 23760,
      "signal_duration_seconds": 2970.0,
      "preprocessing_info": {
        "method": "seizure_only",
        "context_minutes": 30,
        "filter_applied": {
          "low_freq": 0.5,
          "high_freq": 40,
          "order": 4
        },
        "downsampling_factor": 31.25
      }
    }
  },
  "madrid_parameters": {
    "m_range": {
      "min_length": 80,
      "max_length": 800,
      "step_size": 80
    },
    "analysis_config": {
      "top_k": 5,
      "train_test_split_ratio": 0.3,
      "threshold_percentile": 90
    },
    "algorithm_settings": {
      "use_gpu": true,
      "downsampling_factor": 1
    }
  },
  "analysis_results": {
    "anomalies": [
      {
        "rank": 1,
        "m_value": 720,
        "anomaly_score": 0.6722581451411648,
        "location_sample": 7911,
        "location_time_seconds": 988.875,
        "seizure_hit": true,
        "normalized_score": 0.6722581451411648,
        "confidence": 0.6722581451411648,
        "anomaly_id": "m720_rank1_loc7911"
      },
      {
        "rank": 2,
        "m_value": 800,
        "anomaly_score": 0.6720985846603966,
        "location_sample": 7830,
        "location_time_seconds": 978.75,
        "seizure_hit": true,
        "normalized_score": 0.6720985846603966,
        "confidence": 0.6720985846603966,
        "anomaly_id": "m800_rank2_loc7830"
      },
      {
        "rank": 3,
        "m_value": 800,
        "anomaly_score": 0.671613250861685,
        "location_sample": 13000,
        "location_time_seconds": 1625.0,
        "seizure_hit": false,
        "normalized_score": 0.671613250861685,
        "confidence": 0.671613250861685,
        "anomaly_id": "m800_rank3_loc13000"
      },
      {
        "rank": 4,
        "m_value": 640,
        "anomaly_score": 0.6690245744305776,
        "location_sample": 7960,
        "location_time_seconds": 995.0,
        "seizure_hit": true,
        "normalized_score": 0.6690245744305776,
        "confidence": 0.6690245744305776,
        "anomaly_id": "m640_rank4_loc7960"
      },
      {
        "rank": 5,
        "m_value": 720,
        "anomaly_score": 0.668113585148621,
        "location_sample": 12991,
        "location_time_seconds": 1623.875,
        "seizure_hit": false,
        "normalized_score": 0.668113585148621,
        "confidence": 0.668113585148621,
        "anomaly_id": "m720_rank5_loc12991"
      },
      {
        "rank": 6,
        "m_value": 720,
        "anomaly_score": 0.6673989389012358,
        "location_sample": 13190,
        "location_time_seconds": 1648.75,
        "seizure_hit": false,
        "normalized_score": 0.6673989389012358,
        "confidence": 0.6673989389012358,
        "anomaly_id": "m720_rank6_loc13190"
      },
      {
        "rank": 7,
        "m_value": 640,
        "anomaly_score": 0.6648946169300731,
        "location_sample": 13032,
        "location_time_seconds": 1629.0,
        "seizure_hit": false,
        "normalized_score": 0.6648946169300731,
        "confidence": 0.6648946169300731,
        "anomaly_id": "m640_rank7_loc13032"
      },
      {
        "rank": 8,
        "m_value": 800,
        "anomaly_score": 0.6648738198932072,
        "location_sample": 13200,
        "location_time_seconds": 1650.0,
        "seizure_hit": false,
        "normalized_score": 0.6648738198932072,
        "confidence": 0.6648738198932072,
        "anomaly_id": "m800_rank8_loc13200"
      },
      {
        "rank": 9,
        "m_value": 800,
        "anomaly_score": 0.6648384645541366,
        "location_sample": 13400,
        "location_time_seconds": 1675.0,
        "seizure_hit": false,
        "normalized_score": 0.6648384645541366,
        "confidence": 0.6648384645541366,
        "anomaly_id": "m800_rank9_loc13400"
      },
      {
        "rank": 10,
        "m_value": 800,
        "anomaly_score": 0.664803109215066,
        "location_sample": 13600,
        "location_time_seconds": 1700.0,
        "seizure_hit": false,
        "normalized_score": 0.664803109215066,
        "confidence": 0.664803109215066,
        "anomaly_id": "m800_rank10_loc13600"
      },
      {
        "rank": 11,
        "m_value": 400,
        "anomaly_score": 0.6641630468553053,
        "location_sample": 8247,
        "location_time_seconds": 1030.875,
        "seizure_hit": true,
        "normalized_score": 0.6641630468553053,
        "confidence": 0.6641630468553053,
        "anomaly_id": "m400_rank11_loc8247"
      },
      {
        "rank": 12,
        "m_value": 560,
        "anomaly_score": 0.6641225384755354,
        "location_sample": 8065,
        "location_time_seconds": 1008.125,
        "seizure_hit": true,
        "normalized_score": 0.6641225384755354,
        "confidence": 0.6641225384755354,
        "anomaly_id": "m560_rank12_loc8065"
      },
      {
        "rank": 13,
        "m_value": 640,
        "anomaly_score": 0.6630848523333468,
        "location_sample": 13192,
        "location_time_seconds": 1649.0,
        "seizure_hit": false,
        "normalized_score": 0.6630848523333468,
        "confidence": 0.6630848523333468,
        "anomaly_id": "m640_rank13_loc13192"
      },
      {
        "rank": 14,
        "m_value": 560,
        "anomaly_score": 0.6619756624121894,
        "location_sample": 13103,
        "location_time_seconds": 1637.875,
        "seizure_hit": false,
        "normalized_score": 0.6619756624121894,
        "confidence": 0.6619756624121894,
        "anomaly_id": "m560_rank14_loc13103"
      },
      {
        "rank": 15,
        "m_value": 480,
        "anomaly_score": 0.6614759602942392,
        "location_sample": 8140,
        "location_time_seconds": 1017.5,
        "seizure_hit": true,
        "normalized_score": 0.6614759602942392,
        "confidence": 0.6614759602942392,
        "anomaly_id": "m480_rank15_loc8140"
      },
      {
        "rank": 16,
        "m_value": 640,
        "anomaly_score": 0.6602290128559939,
        "location_sample": 8127,
        "location_time_seconds": 1015.875,
        "seizure_hit": true,
        "normalized_score": 0.6602290128559939,
        "confidence": 0.6602290128559939,
        "anomaly_id": "m640_rank16_loc8127"
      },
      {
        "rank": 17,
        "m_value": 720,
        "anomaly_score": 0.6602055292448838,
        "location_sample": 13370,
        "location_time_seconds": 1671.25,
        "seizure_hit": false,
        "normalized_score": 0.6602055292448838,
        "confidence": 0.6602055292448838,
        "anomaly_id": "m720_rank17_loc13370"
      },
      {
        "rank": 18,
        "m_value": 480,
        "anomaly_score": 0.6601866324642065,
        "location_sample": 13103,
        "location_time_seconds": 1637.875,
        "seizure_hit": false,
        "normalized_score": 0.6601866324642065,
        "confidence": 0.6601866324642065,
        "anomaly_id": "m480_rank18_loc13103"
      },
      {
        "rank": 19,
        "m_value": 720,
        "anomaly_score": 0.6601719882252107,
        "location_sample": 13550,
        "location_time_seconds": 1693.75,
        "seizure_hit": false,
        "normalized_score": 0.6601719882252107,
        "confidence": 0.6601719882252107,
        "anomaly_id": "m720_rank19_loc13550"
      },
      {
        "rank": 20,
        "m_value": 320,
        "anomaly_score": 0.6596942146432768,
        "location_sample": 8331,
        "location_time_seconds": 1041.375,
        "seizure_hit": true,
        "normalized_score": 0.6596942146432768,
        "confidence": 0.6596942146432768,
        "anomaly_id": "m320_rank20_loc8331"
      },
      {
        "rank": 21,
        "m_value": 560,
        "anomaly_score": 0.6593598822846364,
        "location_sample": 7903,
        "location_time_seconds": 987.875,
        "seizure_hit": true,
        "normalized_score": 0.6593598822846364,
        "confidence": 0.6593598822846364,
        "anomaly_id": "m560_rank21_loc7903"
      },
      {
        "rank": 22,
        "m_value": 640,
        "anomaly_score": 0.6592664855537106,
        "location_sample": 7756,
        "location_time_seconds": 969.5,
        "seizure_hit": true,
        "normalized_score": 0.6592664855537106,
        "confidence": 0.6592664855537106,
        "anomaly_id": "m640_rank22_loc7756"
      }
    ],
    "performance_metrics": {
      "total_anomalies_detected": 22,
      "threshold_used": 0.6589253452401315,
      "analysis_successful": true,
      "true_positives": 10,
      "false_positives": 12,
      "sensitivity": 10.0,
      "precision": 0.45454545454545453
    },
    "multi_length_matrix": {
      "description": "Multi-length discord table with normalized scores",
      "shape": [
        10,
        23760
      ],
      "m_values": [
        80,
        160,
        240,
        320,
        400,
        480,
        560,
        640,
        720,
        800
      ],
      "statistics": {
        "max_score": 0.6722581451411648,
        "min_score": 0.6352418399193801,
        "mean_score": 0.6603624100393982,
        "std_score": 0.010662259906785047
      }
    }
  },
  "validation_data": {
    "ground_truth": {
      "seizure_present": true,
      "seizure_regions": [
        {
          "onset_sample": 7608,
          "offset_sample": 11112,
          "onset_time_seconds": 951.0,
          "offset_time_seconds": 1389.0,
          "duration_seconds": 438.0,
          "seizure_type": "focal",
          "confidence": 1.0
        }
      ],
      "annotation_source": "seizure_only_preprocessing",
      "annotator_id": "automated"
    },
    "seizure_overlap_info": [
      {
        "anomaly_id": "m720_rank1_loc7911",
        "overlap_with_seizure": true,
        "overlap_sample_start": 7608,
        "overlap_sample_end": 11112,
        "overlap_ratio": 1.0,
        "distance_to_onset": 303,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m800_rank2_loc7830",
        "overlap_with_seizure": true,
        "overlap_sample_start": 7608,
        "overlap_sample_end": 11112,
        "overlap_ratio": 1.0,
        "distance_to_onset": 222,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m800_rank3_loc13000",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m640_rank4_loc7960",
        "overlap_with_seizure": true,
        "overlap_sample_start": 7608,
        "overlap_sample_end": 11112,
        "overlap_ratio": 1.0,
        "distance_to_onset": 352,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m720_rank5_loc12991",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m720_rank6_loc13190",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m640_rank7_loc13032",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m800_rank8_loc13200",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m800_rank9_loc13400",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m800_rank10_loc13600",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m400_rank11_loc8247",
        "overlap_with_seizure": true,
        "overlap_sample_start": 7608,
        "overlap_sample_end": 11112,
        "overlap_ratio": 1.0,
        "distance_to_onset": 639,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m560_rank12_loc8065",
        "overlap_with_seizure": true,
        "overlap_sample_start": 7608,
        "overlap_sample_end": 11112,
        "overlap_ratio": 1.0,
        "distance_to_onset": 457,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m640_rank13_loc13192",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m560_rank14_loc13103",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m480_rank15_loc8140",
        "overlap_with_seizure": true,
        "overlap_sample_start": 7608,
        "overlap_sample_end": 11112,
        "overlap_ratio": 1.0,
        "distance_to_onset": 532,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m640_rank16_loc8127",
        "overlap_with_seizure": true,
        "overlap_sample_start": 7608,
        "overlap_sample_end": 11112,
        "overlap_ratio": 1.0,
        "distance_to_onset": 519,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m720_rank17_loc13370",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m480_rank18_loc13103",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m720_rank19_loc13550",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m320_rank20_loc8331",
        "overlap_with_seizure": true,
        "overlap_sample_start": 7608,
        "overlap_sample_end": 11112,
        "overlap_ratio": 1.0,
        "distance_to_onset": 723,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m560_rank21_loc7903",
        "overlap_with_seizure": true,
        "overlap_sample_start": 7608,
        "overlap_sample_end": 11112,
        "overlap_ratio": 1.0,
        "distance_to_onset": 295,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m640_rank22_loc7756",
        "overlap_with_seizure": true,
        "overlap_sample_start": 7608,
        "overlap_sample_end": 11112,
        "overlap_ratio": 1.0,
        "distance_to_onset": 148,
        "classification": "true_positive"
      }
    ]
  }
}