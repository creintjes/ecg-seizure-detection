{
  "analysis_metadata": {
    "analysis_id": "madrid_sub-010_run-08_seizure_00_20250623_163147",
    "timestamp": "2025-06-23T16:31:47.762164Z",
    "madrid_version": "1.0.0",
    "analysis_type": "single_file",
    "computation_info": {
      "execution_time_seconds": 160.29919600486755,
      "gpu_used": true,
      "memory_peak_mb": 0,
      "analysis_successful": true
    }
  },
  "input_data": {
    "source_file": "/home/swolf/asim_shared/preprocessed_data/seizure_only/8hz_30min/downsample_8hz_context_30min/sub-010_run-08_seizure_00_preprocessed.pkl",
    "subject_id": "sub-010",
    "run_id": "run-08",
    "seizure_id": "seizure_00",
    "signal_metadata": {
      "sampling_rate": 8,
      "original_sampling_rate": 250,
      "signal_length_samples": 18148,
      "signal_duration_seconds": 2268.5,
      "preprocessing_info": {
        "method": "seizure_only",
        "context_minutes": 30,
        "filter_applied": {
          "low_freq": 0.5,
          "high_freq": 40,
          "order": 4
        },
        "downsampling_factor": 31.25
      }
    }
  },
  "madrid_parameters": {
    "m_range": {
      "min_length": 80,
      "max_length": 800,
      "step_size": 80
    },
    "analysis_config": {
      "top_k": 5,
      "train_test_split_ratio": 0.3,
      "threshold_percentile": 90
    },
    "algorithm_settings": {
      "use_gpu": true,
      "downsampling_factor": 1
    }
  },
  "analysis_results": {
    "anomalies": [
      {
        "rank": 1,
        "m_value": 800,
        "anomaly_score": 0.6475409130391718,
        "location_sample": 7307,
        "location_time_seconds": 913.375,
        "seizure_hit": false,
        "normalized_score": 0.6475409130391718,
        "confidence": 0.6475409130391718,
        "anomaly_id": "m800_rank1_loc7307"
      },
      {
        "rank": 2,
        "m_value": 720,
        "anomaly_score": 0.6456313654974236,
        "location_sample": 7307,
        "location_time_seconds": 913.375,
        "seizure_hit": false,
        "normalized_score": 0.6456313654974236,
        "confidence": 0.6456313654974236,
        "anomaly_id": "m720_rank2_loc7307"
      },
      {
        "rank": 3,
        "m_value": 640,
        "anomaly_score": 0.6376029750352097,
        "location_sample": 7307,
        "location_time_seconds": 913.375,
        "seizure_hit": false,
        "normalized_score": 0.6376029750352097,
        "confidence": 0.6376029750352097,
        "anomaly_id": "m640_rank3_loc7307"
      },
      {
        "rank": 4,
        "m_value": 560,
        "anomaly_score": 0.6325570730928366,
        "location_sample": 7307,
        "location_time_seconds": 913.375,
        "seizure_hit": false,
        "normalized_score": 0.6325570730928366,
        "confidence": 0.6325570730928366,
        "anomaly_id": "m560_rank4_loc7307"
      },
      {
        "rank": 5,
        "m_value": 720,
        "anomaly_score": 0.628701694110584,
        "location_sample": 7513,
        "location_time_seconds": 939.125,
        "seizure_hit": false,
        "normalized_score": 0.628701694110584,
        "confidence": 0.628701694110584,
        "anomaly_id": "m720_rank5_loc7513"
      },
      {
        "rank": 6,
        "m_value": 320,
        "anomaly_score": 0.6277169460290203,
        "location_sample": 14251,
        "location_time_seconds": 1781.375,
        "seizure_hit": true,
        "normalized_score": 0.6277169460290203,
        "confidence": 0.6277169460290203,
        "anomaly_id": "m320_rank6_loc14251"
      },
      {
        "rank": 7,
        "m_value": 480,
        "anomaly_score": 0.6257460140014022,
        "location_sample": 7307,
        "location_time_seconds": 913.375,
        "seizure_hit": false,
        "normalized_score": 0.6257460140014022,
        "confidence": 0.6257460140014022,
        "anomaly_id": "m480_rank7_loc7307"
      },
      {
        "rank": 8,
        "m_value": 240,
        "anomaly_score": 0.6251681845806312,
        "location_sample": 14337,
        "location_time_seconds": 1792.125,
        "seizure_hit": true,
        "normalized_score": 0.6251681845806312,
        "confidence": 0.6251681845806312,
        "anomaly_id": "m240_rank8_loc14337"
      },
      {
        "rank": 9,
        "m_value": 240,
        "anomaly_score": 0.623246685873886,
        "location_sample": 14397,
        "location_time_seconds": 1799.625,
        "seizure_hit": true,
        "normalized_score": 0.623246685873886,
        "confidence": 0.623246685873886,
        "anomaly_id": "m240_rank9_loc14397"
      },
      {
        "rank": 10,
        "m_value": 240,
        "anomaly_score": 0.6232273209571556,
        "location_sample": 14457,
        "location_time_seconds": 1807.125,
        "seizure_hit": true,
        "normalized_score": 0.6232273209571556,
        "confidence": 0.6232273209571556,
        "anomaly_id": "m240_rank10_loc14457"
      },
      {
        "rank": 11,
        "m_value": 240,
        "anomaly_score": 0.6232079560404253,
        "location_sample": 14517,
        "location_time_seconds": 1814.625,
        "seizure_hit": true,
        "normalized_score": 0.6232079560404253,
        "confidence": 0.6232079560404253,
        "anomaly_id": "m240_rank11_loc14517"
      },
      {
        "rank": 12,
        "m_value": 240,
        "anomaly_score": 0.6231885911236951,
        "location_sample": 14577,
        "location_time_seconds": 1822.125,
        "seizure_hit": true,
        "normalized_score": 0.6231885911236951,
        "confidence": 0.6231885911236951,
        "anomaly_id": "m240_rank12_loc14577"
      },
      {
        "rank": 13,
        "m_value": 640,
        "anomaly_score": 0.6227831415074774,
        "location_sample": 13853,
        "location_time_seconds": 1731.625,
        "seizure_hit": true,
        "normalized_score": 0.6227831415074774,
        "confidence": 0.6227831415074774,
        "anomaly_id": "m640_rank13_loc13853"
      },
      {
        "rank": 14,
        "m_value": 640,
        "anomaly_score": 0.6227515187308769,
        "location_sample": 14013,
        "location_time_seconds": 1751.625,
        "seizure_hit": true,
        "normalized_score": 0.6227515187308769,
        "confidence": 0.6227515187308769,
        "anomaly_id": "m640_rank14_loc14013"
      },
      {
        "rank": 15,
        "m_value": 640,
        "anomaly_score": 0.6227198959542763,
        "location_sample": 14173,
        "location_time_seconds": 1771.625,
        "seizure_hit": true,
        "normalized_score": 0.6227198959542763,
        "confidence": 0.6227198959542763,
        "anomaly_id": "m640_rank15_loc14173"
      },
      {
        "rank": 16,
        "m_value": 640,
        "anomaly_score": 0.6226882731776759,
        "location_sample": 14333,
        "location_time_seconds": 1791.625,
        "seizure_hit": true,
        "normalized_score": 0.6226882731776759,
        "confidence": 0.6226882731776759,
        "anomaly_id": "m640_rank16_loc14333"
      },
      {
        "rank": 17,
        "m_value": 800,
        "anomaly_score": 0.6217691640947253,
        "location_sample": 7559,
        "location_time_seconds": 944.875,
        "seizure_hit": false,
        "normalized_score": 0.6217691640947253,
        "confidence": 0.6217691640947253,
        "anomaly_id": "m800_rank17_loc7559"
      },
      {
        "rank": 18,
        "m_value": 800,
        "anomaly_score": 0.6210386579454433,
        "location_sample": 10098,
        "location_time_seconds": 1262.25,
        "seizure_hit": false,
        "normalized_score": 0.6210386579454433,
        "confidence": 0.6210386579454433,
        "anomaly_id": "m800_rank18_loc10098"
      },
      {
        "rank": 19,
        "m_value": 800,
        "anomaly_score": 0.6210295696243471,
        "location_sample": 13781,
        "location_time_seconds": 1722.625,
        "seizure_hit": true,
        "normalized_score": 0.6210295696243471,
        "confidence": 0.6210295696243471,
        "anomaly_id": "m800_rank19_loc13781"
      },
      {
        "rank": 20,
        "m_value": 160,
        "anomaly_score": 0.6208594389804651,
        "location_sample": 7395,
        "location_time_seconds": 924.375,
        "seizure_hit": false,
        "normalized_score": 0.6208594389804651,
        "confidence": 0.6208594389804651,
        "anomaly_id": "m160_rank20_loc7395"
      },
      {
        "rank": 21,
        "m_value": 160,
        "anomaly_score": 0.6200365553114039,
        "location_sample": 11118,
        "location_time_seconds": 1389.75,
        "seizure_hit": false,
        "normalized_score": 0.6200365553114039,
        "confidence": 0.6200365553114039,
        "anomaly_id": "m160_rank21_loc11118"
      },
      {
        "rank": 22,
        "m_value": 320,
        "anomaly_score": 0.6199378489170277,
        "location_sample": 7337,
        "location_time_seconds": 917.125,
        "seizure_hit": false,
        "normalized_score": 0.6199378489170277,
        "confidence": 0.6199378489170277,
        "anomaly_id": "m320_rank22_loc7337"
      },
      {
        "rank": 23,
        "m_value": 800,
        "anomaly_score": 0.6191889295915395,
        "location_sample": 10298,
        "location_time_seconds": 1287.25,
        "seizure_hit": false,
        "normalized_score": 0.6191889295915395,
        "confidence": 0.6191889295915395,
        "anomaly_id": "m800_rank23_loc10298"
      },
      {
        "rank": 24,
        "m_value": 720,
        "anomaly_score": 0.6186556120099711,
        "location_sample": 13799,
        "location_time_seconds": 1724.875,
        "seizure_hit": true,
        "normalized_score": 0.6186556120099711,
        "confidence": 0.6186556120099711,
        "anomaly_id": "m720_rank24_loc13799"
      },
      {
        "rank": 25,
        "m_value": 720,
        "anomaly_score": 0.618622070990298,
        "location_sample": 13979,
        "location_time_seconds": 1747.375,
        "seizure_hit": true,
        "normalized_score": 0.618622070990298,
        "confidence": 0.618622070990298,
        "anomaly_id": "m720_rank25_loc13979"
      },
      {
        "rank": 26,
        "m_value": 720,
        "anomaly_score": 0.6185885299706249,
        "location_sample": 14159,
        "location_time_seconds": 1769.875,
        "seizure_hit": true,
        "normalized_score": 0.6185885299706249,
        "confidence": 0.6185885299706249,
        "anomaly_id": "m720_rank26_loc14159"
      },
      {
        "rank": 27,
        "m_value": 320,
        "anomaly_score": 0.6183092426053667,
        "location_sample": 11171,
        "location_time_seconds": 1396.375,
        "seizure_hit": false,
        "normalized_score": 0.6183092426053667,
        "confidence": 0.6183092426053667,
        "anomaly_id": "m320_rank27_loc11171"
      }
    ],
    "performance_metrics": {
      "total_anomalies_detected": 27,
      "threshold_used": 0.6180371546370567,
      "analysis_successful": true,
      "true_positives": 14,
      "false_positives": 13,
      "sensitivity": 14.0,
      "precision": 0.5185185185185185
    },
    "multi_length_matrix": {
      "description": "Multi-length discord table with normalized scores",
      "shape": [
        10,
        18148
      ],
      "m_values": [
        80,
        160,
        240,
        320,
        400,
        480,
        560,
        640,
        720,
        800
      ],
      "statistics": {
        "max_score": 0.6475409130391718,
        "min_score": 0.5853938799588079,
        "mean_score": 0.6255463534822704,
        "std_score": 0.017480386154445474
      }
    }
  },
  "validation_data": {
    "ground_truth": {
      "seizure_present": true,
      "seizure_regions": [
        {
          "onset_sample": 14020,
          "offset_sample": 14780,
          "onset_time_seconds": 1752.5,
          "offset_time_seconds": 1847.5,
          "duration_seconds": 95.0,
          "seizure_type": "focal",
          "confidence": 1.0
        }
      ],
      "annotation_source": "seizure_only_preprocessing",
      "annotator_id": "automated"
    },
    "seizure_overlap_info": [
      {
        "anomaly_id": "m800_rank1_loc7307",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m720_rank2_loc7307",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m640_rank3_loc7307",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m560_rank4_loc7307",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m720_rank5_loc7513",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m320_rank6_loc14251",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 1.0,
        "distance_to_onset": 231,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m480_rank7_loc7307",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m240_rank8_loc14337",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 1.0,
        "distance_to_onset": 317,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m240_rank9_loc14397",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 1.0,
        "distance_to_onset": 377,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m240_rank10_loc14457",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 1.0,
        "distance_to_onset": 437,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m240_rank11_loc14517",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 1.0,
        "distance_to_onset": 497,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m240_rank12_loc14577",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 1.0,
        "distance_to_onset": 557,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m640_rank13_loc13853",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 0.8,
        "distance_to_onset": 167,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m640_rank14_loc14013",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 0.8,
        "distance_to_onset": 7,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m640_rank15_loc14173",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 1.0,
        "distance_to_onset": 153,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m640_rank16_loc14333",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 1.0,
        "distance_to_onset": 313,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m800_rank17_loc7559",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m800_rank18_loc10098",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m800_rank19_loc13781",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 0.8,
        "distance_to_onset": 239,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m160_rank20_loc7395",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m160_rank21_loc11118",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m320_rank22_loc7337",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m800_rank23_loc10298",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m720_rank24_loc13799",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 0.8,
        "distance_to_onset": 221,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m720_rank25_loc13979",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 0.8,
        "distance_to_onset": 41,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m720_rank26_loc14159",
        "overlap_with_seizure": true,
        "overlap_sample_start": 14020,
        "overlap_sample_end": 14780,
        "overlap_ratio": 1.0,
        "distance_to_onset": 139,
        "classification": "true_positive"
      },
      {
        "anomaly_id": "m320_rank27_loc11171",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      }
    ]
  }
}