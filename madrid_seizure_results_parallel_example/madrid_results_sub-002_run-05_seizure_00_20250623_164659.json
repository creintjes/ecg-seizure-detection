{
  "analysis_metadata": {
    "analysis_id": "madrid_sub-002_run-05_seizure_00_20250623_164659",
    "timestamp": "2025-06-23T16:46:59.875423Z",
    "madrid_version": "1.0.0",
    "analysis_type": "single_file",
    "computation_info": {
      "execution_time_seconds": 209.9636743068695,
      "gpu_used": true,
      "memory_peak_mb": 0,
      "analysis_successful": true
    }
  },
  "input_data": {
    "source_file": "/home/swolf/asim_shared/preprocessed_data/seizure_only/8hz_30min/downsample_8hz_context_30min/sub-002_run-05_seizure_00_preprocessed.pkl",
    "subject_id": "sub-002",
    "run_id": "run-05",
    "seizure_id": "seizure_00",
    "signal_metadata": {
      "sampling_rate": 8,
      "original_sampling_rate": 250,
      "signal_length_samples": 30024,
      "signal_duration_seconds": 3753.0,
      "preprocessing_info": {
        "method": "seizure_only",
        "context_minutes": 30,
        "filter_applied": {
          "low_freq": 0.5,
          "high_freq": 40,
          "order": 4
        },
        "downsampling_factor": 31.25
      }
    }
  },
  "madrid_parameters": {
    "m_range": {
      "min_length": 80,
      "max_length": 800,
      "step_size": 80
    },
    "analysis_config": {
      "top_k": 5,
      "train_test_split_ratio": 0.3,
      "threshold_percentile": 90
    },
    "algorithm_settings": {
      "use_gpu": true,
      "downsampling_factor": 1
    }
  },
  "analysis_results": {
    "anomalies": [
      {
        "rank": 1,
        "m_value": 800,
        "anomaly_score": 0.6564194753284994,
        "location_sample": 10626,
        "location_time_seconds": 1328.25,
        "seizure_hit": false,
        "normalized_score": 0.6564194753284994,
        "confidence": 0.6564194753284994,
        "anomaly_id": "m800_rank1_loc10626"
      },
      {
        "rank": 2,
        "m_value": 800,
        "anomaly_score": 0.6553887096266933,
        "location_sample": 9017,
        "location_time_seconds": 1127.125,
        "seizure_hit": false,
        "normalized_score": 0.6553887096266933,
        "confidence": 0.6553887096266933,
        "anomaly_id": "m800_rank2_loc9017"
      },
      {
        "rank": 3,
        "m_value": 800,
        "anomaly_score": 0.6541116588456418,
        "location_sample": 9529,
        "location_time_seconds": 1191.125,
        "seizure_hit": false,
        "normalized_score": 0.6541116588456418,
        "confidence": 0.6541116588456418,
        "anomaly_id": "m800_rank3_loc9529"
      },
      {
        "rank": 4,
        "m_value": 800,
        "anomaly_score": 0.6539869415521907,
        "location_sample": 10272,
        "location_time_seconds": 1284.0,
        "seizure_hit": false,
        "normalized_score": 0.6539869415521907,
        "confidence": 0.6539869415521907,
        "anomaly_id": "m800_rank4_loc10272"
      },
      {
        "rank": 5,
        "m_value": 800,
        "anomaly_score": 0.6531857522443146,
        "location_sample": 25635,
        "location_time_seconds": 3204.375,
        "seizure_hit": false,
        "normalized_score": 0.6531857522443146,
        "confidence": 0.6531857522443146,
        "anomaly_id": "m800_rank5_loc25635"
      },
      {
        "rank": 6,
        "m_value": 720,
        "anomaly_score": 0.6530077358335171,
        "location_sample": 10697,
        "location_time_seconds": 1337.125,
        "seizure_hit": false,
        "normalized_score": 0.6530077358335171,
        "confidence": 0.6530077358335171,
        "anomaly_id": "m720_rank6_loc10697"
      },
      {
        "rank": 7,
        "m_value": 720,
        "anomaly_score": 0.6529195044648602,
        "location_sample": 9012,
        "location_time_seconds": 1126.5,
        "seizure_hit": false,
        "normalized_score": 0.6529195044648602,
        "confidence": 0.6529195044648602,
        "anomaly_id": "m720_rank7_loc9012"
      },
      {
        "rank": 8,
        "m_value": 720,
        "anomaly_score": 0.652269365491837,
        "location_sample": 25780,
        "location_time_seconds": 3222.5,
        "seizure_hit": false,
        "normalized_score": 0.652269365491837,
        "confidence": 0.652269365491837,
        "anomaly_id": "m720_rank8_loc25780"
      },
      {
        "rank": 9,
        "m_value": 720,
        "anomaly_score": 0.652079500789284,
        "location_sample": 9516,
        "location_time_seconds": 1189.5,
        "seizure_hit": false,
        "normalized_score": 0.652079500789284,
        "confidence": 0.652079500789284,
        "anomaly_id": "m720_rank9_loc9516"
      },
      {
        "rank": 10,
        "m_value": 720,
        "anomaly_score": 0.6507416755928837,
        "location_sample": 22114,
        "location_time_seconds": 2764.25,
        "seizure_hit": false,
        "normalized_score": 0.6507416755928837,
        "confidence": 0.6507416755928837,
        "anomaly_id": "m720_rank10_loc22114"
      },
      {
        "rank": 11,
        "m_value": 640,
        "anomaly_score": 0.6506089480293249,
        "location_sample": 9525,
        "location_time_seconds": 1190.625,
        "seizure_hit": false,
        "normalized_score": 0.6506089480293249,
        "confidence": 0.6506089480293249,
        "anomaly_id": "m640_rank11_loc9525"
      },
      {
        "rank": 12,
        "m_value": 640,
        "anomaly_score": 0.650438783218041,
        "location_sample": 21047,
        "location_time_seconds": 2630.875,
        "seizure_hit": false,
        "normalized_score": 0.650438783218041,
        "confidence": 0.650438783218041,
        "anomaly_id": "m640_rank12_loc21047"
      },
      {
        "rank": 13,
        "m_value": 640,
        "anomaly_score": 0.6501862863945065,
        "location_sample": 9013,
        "location_time_seconds": 1126.625,
        "seizure_hit": false,
        "normalized_score": 0.6501862863945065,
        "confidence": 0.6501862863945065,
        "anomaly_id": "m640_rank13_loc9013"
      },
      {
        "rank": 14,
        "m_value": 640,
        "anomaly_score": 0.6493287761435531,
        "location_sample": 10797,
        "location_time_seconds": 1349.625,
        "seizure_hit": false,
        "normalized_score": 0.6493287761435531,
        "confidence": 0.6493287761435531,
        "anomaly_id": "m640_rank14_loc10797"
      },
      {
        "rank": 15,
        "m_value": 640,
        "anomaly_score": 0.6492971533669414,
        "location_sample": 10957,
        "location_time_seconds": 1369.625,
        "seizure_hit": false,
        "normalized_score": 0.6492971533669414,
        "confidence": 0.6492971533669414,
        "anomaly_id": "m640_rank15_loc10957"
      },
      {
        "rank": 16,
        "m_value": 560,
        "anomaly_score": 0.6464402933661835,
        "location_sample": 10042,
        "location_time_seconds": 1255.25,
        "seizure_hit": false,
        "normalized_score": 0.6464402933661835,
        "confidence": 0.6464402933661835,
        "anomaly_id": "m560_rank16_loc10042"
      },
      {
        "rank": 17,
        "m_value": 560,
        "anomaly_score": 0.6460160272660409,
        "location_sample": 10934,
        "location_time_seconds": 1366.75,
        "seizure_hit": false,
        "normalized_score": 0.6460160272660409,
        "confidence": 0.6460160272660409,
        "anomaly_id": "m560_rank17_loc10934"
      },
      {
        "rank": 18,
        "m_value": 560,
        "anomaly_score": 0.6444837521121535,
        "location_sample": 9530,
        "location_time_seconds": 1191.25,
        "seizure_hit": false,
        "normalized_score": 0.6444837521121535,
        "confidence": 0.6444837521121535,
        "anomaly_id": "m560_rank18_loc9530"
      },
      {
        "rank": 19,
        "m_value": 560,
        "anomaly_score": 0.6444707168979438,
        "location_sample": 11481,
        "location_time_seconds": 1435.125,
        "seizure_hit": false,
        "normalized_score": 0.6444707168979438,
        "confidence": 0.6444707168979438,
        "anomaly_id": "m560_rank19_loc11481"
      },
      {
        "rank": 20,
        "m_value": 560,
        "anomaly_score": 0.64435982375122,
        "location_sample": 23732,
        "location_time_seconds": 2966.5,
        "seizure_hit": false,
        "normalized_score": 0.64435982375122,
        "confidence": 0.64435982375122,
        "anomaly_id": "m560_rank20_loc23732"
      }
    ],
    "performance_metrics": {
      "total_anomalies_detected": 20,
      "threshold_used": 0.6403933965370333,
      "analysis_successful": true,
      "true_positives": 0,
      "false_positives": 20,
      "sensitivity": 0.0,
      "precision": 0.0
    },
    "multi_length_matrix": {
      "description": "Multi-length discord table with normalized scores",
      "shape": [
        10,
        30024
      ],
      "m_values": [
        80,
        160,
        240,
        320,
        400,
        480,
        560,
        640,
        720,
        800
      ],
      "statistics": {
        "max_score": 0.6564194753284994,
        "min_score": 0.5467776674240666,
        "mean_score": 0.6259894489985879,
        "std_score": 0.03238043677452493
      }
    }
  },
  "validation_data": {
    "ground_truth": {
      "seizure_present": true,
      "seizure_regions": [
        {
          "onset_sample": 14400,
          "offset_sample": 15624,
          "onset_time_seconds": 1800.0,
          "offset_time_seconds": 1953.0,
          "duration_seconds": 153.0,
          "seizure_type": "focal",
          "confidence": 1.0
        }
      ],
      "annotation_source": "seizure_only_preprocessing",
      "annotator_id": "automated"
    },
    "seizure_overlap_info": [
      {
        "anomaly_id": "m800_rank1_loc10626",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m800_rank2_loc9017",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m800_rank3_loc9529",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m800_rank4_loc10272",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m800_rank5_loc25635",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m720_rank6_loc10697",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m720_rank7_loc9012",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m720_rank8_loc25780",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m720_rank9_loc9516",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m720_rank10_loc22114",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m640_rank11_loc9525",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m640_rank12_loc21047",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m640_rank13_loc9013",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m640_rank14_loc10797",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m640_rank15_loc10957",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m560_rank16_loc10042",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m560_rank17_loc10934",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m560_rank18_loc9530",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m560_rank19_loc11481",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      },
      {
        "anomaly_id": "m560_rank20_loc23732",
        "overlap_with_seizure": false,
        "overlap_sample_start": null,
        "overlap_sample_end": null,
        "overlap_ratio": 0.0,
        "distance_to_onset": null,
        "classification": "false_positive"
      }
    ]
  }
}